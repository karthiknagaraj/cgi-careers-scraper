<?xml version="1.0" encoding="UTF-8"?>
<svg width="900" height="420" viewBox="0 0 900 420" xmlns="http://www.w3.org/2000/svg">
  <style>
    .box { fill:#f8fafc; stroke:#1f2937; stroke-width:1; rx:6; }
    .title { font: bold 14px sans-serif; fill:#0f172a; }
    .label { font: 12px sans-serif; fill:#0f172a; }
    .arrow { stroke:#0f172a; stroke-width:2; fill:none; marker-end:url(#arrowhead);} 
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0f172a" />
    </marker>
  </defs>

  <!-- Start -->
  <rect x="40" y="20" width="160" height="48" class="box"/>
  <text x="120" y="52" text-anchor="middle" class="title">Start</text>

  <!-- Fetch mode decision -->
  <rect x="260" y="12" width="220" height="68" class="box"/>
  <text x="370" y="32" text-anchor="middle" class="title">Fetch Pages</text>
  <text x="370" y="52" text-anchor="middle" class="label">requests OR Playwright</text>

  <!-- Extract Table -->
  <rect x="540" y="12" width="220" height="68" class="box"/>
  <text x="650" y="32" text-anchor="middle" class="title">Extract Table</text>
  <text x="650" y="52" text-anchor="middle" class="label">DOM or parsed text</text>

  <!-- Follow details decision -->
  <rect x="260" y="130" width="220" height="68" class="box"/>
  <text x="370" y="150" text-anchor="middle" class="title">Follow Details?</text>
  <text x="370" y="170" text-anchor="middle" class="label">Optional (slower)</text>

  <!-- Detail parse -->
  <rect x="540" y="130" width="220" height="68" class="box"/>
  <text x="650" y="150" text-anchor="middle" class="title">Parse Detail</text>
  <text x="650" y="170" text-anchor="middle" class="label">JSON-LD `validThrough`, visible text</text>

  <!-- Filter & CSV -->
  <rect x="40" y="260" width="260" height="88" class="box"/>
  <text x="170" y="288" text-anchor="middle" class="title">Filter Jobs</text>
  <text x="170" y="308" text-anchor="middle" class="label">keywords, regex, any/all</text>

  <rect x="340" y="260" width="420" height="88" class="box"/>
  <text x="560" y="290" text-anchor="middle" class="title">Write CSV</text>
  <text x="560" y="310" text-anchor="middle" class="label">data/jobs_YYYYMMDD.csv</text>

  <!-- Arrows -->
  <path d="M200 44 L260 44" class="arrow" />
  <path d="M480 44 L540 44" class="arrow" />
  <path d="M480 44 L360 44" class="arrow" stroke-dasharray="6 4" />
  <path d="M370 80 L370 130" class="arrow" />
  <path d="M480 160 L540 160" class="arrow" />
  <path d="M360 198 L360 260" class="arrow" />
  <path d="M480 98 L480 260" class="arrow" stroke-dasharray="6 4" />
  <path d="M700 198 L700 260" class="arrow" />

  <!-- Notes -->
  <text x="40" y="380" class="label">Key: solid arrows indicate primary flow; dashed indicate optional branches (e.g., follow details).</text>
</svg>